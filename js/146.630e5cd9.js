"use strict";(self["webpackChunkchitter"]=self["webpackChunkchitter"]||[]).push([[146],{6146:function(e,t,i){i.r(t),i.d(t,{default:function(){return P}});var a=i(3396),n=i(4870),l=i(988),r=i(9242),s=i(7925),o=i(171),c=i(7139),u=i(8341),w=i(9327);const d={class:"icon-container"},f={key:0,class:"notif-icon"},m={key:1,class:"notif-icon"},v={key:2,class:"notif-icon"},p={class:"notif-body"},y={class:"notif-text"},k={class:"tweet-text gray-text"},g={key:0};var U={__name:"NotificationCard",props:{type:String,id:String,avatarUrl:String,name:String,username:String,tweetText:String,containsMedia:Boolean,isNew:Boolean},setup(e){const t=e,i=(0,w.q)(),l=(0,a.Fl)((()=>{switch(t.type){case"like-origin":return" liked your Tweet";case"like-retweet":return" liked your Retweet";case"retweet-origin":return" Retweeted your Tweet";case"retweet-retweet":return" Retweeted your Retweet";default:return" followed you"}})),r=(0,a.Fl)((()=>` pic.chitter.com/${t.id}`)),s=(0,a.Fl)((()=>"like-origin"===t.type||"like-retweet"===t.type)),o=(0,a.Fl)((()=>"retweet-origin"===t.type||"retweet-retweet"===t.type));function U(){"follow"===t.type?i.viewUserProfile(t.username):i.viewTweet(t.id)}return(i,w)=>{const _=(0,a.up)("v-icon");return(0,a.wg)(),(0,a.iD)("div",{class:(0,c.C_)(["notif-container",{new:e.isNew}]),onClick:U},[(0,a._)("div",d,[(0,n.SU)(s)?((0,a.wg)(),(0,a.iD)("span",f,[(0,a.Wm)(_,{name:"bi-heart-fill",scale:"1.6",fill:"#e21c68"})])):(0,n.SU)(o)?((0,a.wg)(),(0,a.iD)("span",m,[(0,a.Wm)(_,{name:"la-retweet-solid",scale:"1.6",fill:"#10d3a9"})])):"follow"===t.type?((0,a.wg)(),(0,a.iD)("span",v,[(0,a.Wm)(_,{name:"io-person",scale:"1.5",fill:"#14b5f5"})])):(0,a.kq)("",!0)]),(0,a._)("div",p,[(0,a.Wm)(u.Z,{url:t.avatarUrl,size:32},null,8,["url"]),(0,a._)("div",y,[(0,a._)("strong",null,(0,c.zw)(t.name),1),(0,a.Uk)((0,c.zw)((0,n.SU)(l)),1)]),(0,a._)("div",k,[(0,a.Uk)((0,c.zw)(t.tweetText),1),e.containsMedia?((0,a.wg)(),(0,a.iD)("span",g,(0,c.zw)((0,n.SU)(r)),1)):(0,a.kq)("",!0)])])],2)}}};const _=U;var S=_,N=i(3301),h=i.n(N);const x={class:"notif-list"},C={key:1,class:"error gray-text"};var b={__name:"NotificationList",props:{notifs:Array},async setup(e){let t,i;const c=e;var u=new(h());const w=(0,s.g)(),d=(0,l.U)(),f=(0,n.iH)(([t,i]=(0,a.mv)((async()=>Promise.all(c.notifs.map((async e=>{const t=e.tweetId?await w.getTweet(e.tweetId):null;if("reply"===e.type||"mention"===e.type)return Object.assign(e,{id:t.id,tweet:t,isNewNotification:d.tweetIsNewNotification(e.tweetId)});{const i=await d.getUser(e.fromUser);return Object.assign(e,{id:t?t.id:null,type:e.type,name:i.name,username:i.username,avatarUrl:i.avatarUrl,tweetText:t?t.text:null,containsMedia:t?t.media.length>0:null,isNew:d.isNewNotification(e)})}}))))),t=await t,i(),t).reverse());return(e,t)=>((0,a.wg)(),(0,a.iD)("div",x,[f.value.length>0?((0,a.wg)(),(0,a.j4)(r.W3,{key:0,name:"fade-down"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(f.value,((e,t)=>((0,a.wg)(),(0,a.iD)(a.HY,null,["reply"===e.type?((0,a.wg)(),(0,a.j4)(o.Z,{key:e.id+(0,n.SU)(u)(),id:e.id,user:(0,n.SU)(d).getUserProps(e.fromUser),tweet:e.tweet,type:"reply",replyingTo:(0,n.SU)(d).currentUser.username,isNewNotification:e.isNewNotification},null,8,["id","user","tweet","replyingTo","isNewNotification"])):"mention"===e.type?((0,a.wg)(),(0,a.j4)(o.Z,{key:e.id+(0,n.SU)(u)(),id:e.id,user:(0,n.SU)(d).getUserProps(e.fromUser),tweet:e.tweet,type:"status",isNewNotification:e.isNewNotification},null,8,["id","user","tweet","isNewNotification"])):"reply"!==e.type&&"follow"!==e.type?((0,a.wg)(),(0,a.j4)(S,{key:t+(0,n.SU)(u)(),id:e.id,type:e.type,avatarUrl:e.avatarUrl,name:e.name,username:e.username,tweetText:e.tweetText,containsMedia:e.media&&e.media.length>0,isNew:e.isNew},null,8,["id","type","avatarUrl","name","username","tweetText","containsMedia","isNew"])):((0,a.wg)(),(0,a.j4)(S,{key:t+(0,n.SU)(u)(),type:e.type,avatarUrl:e.avatarUrl,name:e.name,username:e.username,isNew:e.isNew},null,8,["type","avatarUrl","name","username","isNew"]))],64)))),256))])),_:1})):((0,a.wg)(),(0,a.iD)("div",C,"No notifications to display"))]))}},D=i(89);const T=(0,D.Z)(b,[["__scopeId","data-v-26b45e8c"]]);var I=T;const q={class:"tweet-list-container"};var M={__name:"NotificationView",setup(e){const t=(0,l.U)(),i=(0,a.Fl)((()=>t.getAllNotifications()));return(0,a.Ah)((()=>{t.clearNotifications()})),(e,t)=>((0,a.wg)(),(0,a.iD)("div",q,[(0,a.Wm)(I,{notifs:(0,n.SU)(i)},null,8,["notifs"])]))}};const H=M;var P=H},6601:function(e,t,i){i.d(t,{Z:function(){return w}});var a=i(3396),n=i(4870),l=i(9707),r=i(9327);const s=["innerHTML"];var o={__name:"EmbeddedText",props:["text"],setup(e){const t=e,i=(0,r.q)(),o=(0,n.iH)(null);function c(){if(!t.text||0===t.text.length)return;const e=t.text.split(" ").map((e=>{const t=e.split(/\r?\n/);switch(!0){case l.yV.test(e):return`<a class="blue-link" href="${e}" target="_blank">${e}</a>`;case l.nC.test(e):return`<a class="blue-link">${e}</a>`;case t.some((e=>l.PH.test(e))):return t.map((i=>l.PH.test(i)?`<a class="blue-link user-link" data-username=${e.replace("@","")}>${t.filter((e=>l.PH.test(e)))[0]}</a>`:i)).join("\n");default:return e}}));return e.join(" ")}const u=e=>{e.stopPropagation(),i.viewUserProfile(e.currentTarget.dataset.username)};return(0,a.bv)((()=>{const e=o.value.querySelectorAll(".user-link");Array.from(e).forEach((e=>e.addEventListener("click",u)))})),(0,a.Xn)((()=>{const e=o.value.querySelectorAll(".user-link");Array.from(e).forEach((e=>e.removeEventListener("click",u)))})),(0,a.ic)((()=>{const e=o.value.querySelectorAll(".user-link");Array.from(e).forEach((e=>e.addEventListener("click",u)))})),(0,a.Jd)((()=>{const e=o.value.querySelectorAll(".user-link");Array.from(e).forEach((e=>e.removeEventListener("click",u)))})),(e,t)=>((0,a.wg)(),(0,a.iD)("div",{ref_key:"textEl",ref:o,innerHTML:c()},null,8,s))}},c=i(89);const u=(0,c.Z)(o,[["__scopeId","data-v-50c560dd"]]);var w=u},171:function(e,t,i){i.d(t,{Z:function(){return ee}});var a=i(3396),n=i(7139),l=i(4870),r=i(9242),s=i(5743),o=i.n(s),c=i(8341),u=i(6601),w=i(1172),d=i(9707),f=i(7925),m=i(9327),v=i(988);const p={key:0,class:"user-retweet gray-text"},y={class:"retweeted-by"},k={class:"tweet-body"},g={class:"profile-pic-container"},U={key:0,class:"gray-line"},_={class:"tweet-data"},S={class:"user-info-and-btn"},N={class:"user-info-wrapper"},h=(0,a._)("span",{class:"separator gray-text"},"Â·",-1),x={class:"tweet-time gray-text"},C=["onClick"],b={key:0,class:"overlay"},D={key:1,class:"tweet-menu-container"},T={class:"tweet-menu-list"},I={class:"tweet-menu-icon"},q={class:"tweet-menu-icon"},M={class:"tweet-menu-icon"},H=(0,a._)("button",{class:"cancel-btn"},"Cancel",-1),P={class:"tweet-content"},z={key:0,class:"replying-to"},W=(0,a._)("span",{class:"gray-text"},"Replying to ",-1),R={class:"tweet-text"},A=["src"],Z={class:"tweet-actions-wrapper"},j={class:"tweet-metrics"},E=["onClick"],F={class:"tweet-metric reply-metric gray-text"},L={class:"tweet-metrics"},B=["onClick"],$={class:"tweet-metric retweet-metric gray-text"},O={key:0},Y={class:"tweet-metrics"},J=["onClick"],K={class:"tweet-metric like-metric gray-text"},V={key:0},X=["onClick"];var G={__name:"TweetCard",props:{id:String,user:[Object,Promise],tweet:Object,retweetedBy:String,replyingTo:[String,Promise],isPreviousReply:Boolean,isNewNotification:Boolean},async setup(e){let t,s;const G=e,Q=(0,f.g)(),ee=(0,m.q)(),te=(0,v.U)(),ie=(0,l.iH)(([t,s]=(0,a.mv)((()=>G.user)),t=await t,s(),t)),ae=(0,l.iH)(([t,s]=(0,a.mv)((()=>G.replyingTo)),t=await t,s(),t));var ne=i(893);o().extend(ne);let le=null;const re=(0,l.iH)(!1),se=(0,l.iH)(o()().toISOString()),oe=(0,l.iH)(w.Z.formatTweetDate(G.tweet.timestamp,se.value)),ce=(0,l.iH)(G.tweet.likeCount),ue=(0,l.iH)(([t,s]=(0,a.mv)((()=>Q.hasLiked(G.id,te.currentId))),t=await t,s(),t)),we=(0,l.iH)(G.tweet.retweetCount),de=(0,l.iH)(([t,s]=(0,a.mv)((()=>Q.hasRetweeted(G.id,te.currentId))),t=await t,s(),t)),fe=(0,a.Fl)((()=>te.canFollow(ie.value.id))),me=()=>{te.currentId&&(re.value=!re.value)},ve=()=>{te.currentId&&Q.removeTweet(G.id,ie.value.id)},pe=()=>{te.currentId&&(ue.value?(Q.removeLike(G.id,te.currentId,ie.value.id),ce.value--,ue.value=!1):(Q.addLike(G.id,te.currentId,G.retweetedBy),ce.value++,ue.value=!0))},ye=()=>{te.currentId&&(de.value?(Q.removeRetweet(G.id,te.currentId,ie.value.id),we.value--,de.value=!1):(Q.addRetweet(G.id,te.currentId,G.retweetedBy),we.value++,de.value=!0))},ke=()=>{te.currentId&&(ee.setModalType("reply"),ee.setModalReply(ie.value.id,G.id),ee.toggleModal())},ge=()=>{ee.toast("Copied to clipboard"),navigator.clipboard.writeText(`${window.location.host}/chitter/status/${G.id}`)};return(0,a.bv)((()=>{o()(se.value).diff(o()(G.tweet.timestamp),"hour")>23||(le=setInterval((()=>{oe.value!==w.Z.formatTweetDate(G.tweet.timestamp,se.value)&&(oe.value=w.Z.formatTweetDate(G.tweet.timestamp,se.value))}),3e4))})),(0,a.Jd)((()=>{clearInterval(le)})),(t,i)=>{const s=(0,a.up)("v-icon");return(0,a.wg)(),(0,a.iD)("div",{class:(0,n.C_)(["tweet-container",{border:!e.isPreviousReply,new:e.isNewNotification}]),onClick:i[6]||(i[6]=e=>(0,l.SU)(ee).viewTweet(G.id))},[G.retweetedBy?((0,a.wg)(),(0,a.iD)("div",p,[(0,a.Wm)(s,{name:"la-retweet-solid",scale:"0.89",fill:"#ffffff80"}),(0,a._)("span",y,(0,n.zw)(G.retweetedBy)+" Retweeted",1)])):(0,a.kq)("",!0),(0,a._)("div",k,[(0,a._)("div",g,[(0,a.Wm)(c.Z,{url:ie.value.avatarUrl,size:48,onClick:i[0]||(i[0]=(0,r.iM)((e=>(0,l.SU)(ee).viewUserProfile(ie.value.username)),["stop"]))},null,8,["url"]),e.isPreviousReply?((0,a.wg)(),(0,a.iD)("div",U)):(0,a.kq)("",!0)]),(0,a._)("div",_,[(0,a._)("div",S,[(0,a._)("div",N,[(0,a._)("span",{class:"display-name",onClick:i[1]||(i[1]=(0,r.iM)((e=>(0,l.SU)(ee).viewUserProfile(ie.value.username)),["stop"]))},[(0,a._)("a",null,(0,n.zw)(ie.value.name),1)]),(0,a._)("span",{class:"username gray-text",onClick:i[2]||(i[2]=(0,r.iM)((e=>(0,l.SU)(ee).viewUserProfile(ie.value.username)),["stop"]))},[(0,a._)("a",null,"@"+(0,n.zw)(ie.value.username),1)]),h,(0,a._)("span",x,(0,n.zw)(oe.value),1)]),(0,a._)("span",{class:"tweet-action-icon extra-btn",onClick:(0,r.iM)(me,["stop"])},[(0,a.Wm)(s,{name:"hi-dots-horizontal",scale:"1.0",fill:"#ffffff80"}),re.value?((0,a.wg)(),(0,a.iD)("div",b)):(0,a.kq)("",!0),re.value?((0,a.wg)(),(0,a.iD)("div",D,[(0,a._)("ul",T,[(0,l.SU)(te).currentId==ie.value.id||(0,l.SU)(te).currentUser.isAdmin?((0,a.wg)(),(0,a.iD)("li",{key:0,class:"tweet-menu-item delete-tweet",onClick:ve},[(0,a._)("span",I,[(0,a.Wm)(s,{name:"bi-trash",scale:"1.1",fill:"red"})]),(0,a.Uk)("Delete ")])):(0,a.kq)("",!0),(0,l.SU)(te).currentId!==ie.value.id&&(0,l.SU)(fe)?((0,a.wg)(),(0,a.iD)("li",{key:1,class:"tweet-menu-item",onClick:i[3]||(i[3]=e=>(0,l.SU)(te).followUser(ie.value.id))},[(0,a._)("span",q,[(0,a.Wm)(s,{name:"co-user-follow",scale:"1.1",fill:"#ffffff80"})]),(0,a.Uk)("Follow @"+(0,n.zw)(ie.value.username),1)])):(0,a.kq)("",!0),(0,l.SU)(te).currentId===ie.value.id||(0,l.SU)(fe)?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("li",{key:2,class:"tweet-menu-item",onClick:i[4]||(i[4]=e=>(0,l.SU)(te).unfollowUser(ie.value.id))},[(0,a._)("span",M,[(0,a.Wm)(s,{name:"co-user-unfollow",scale:"1.1",fill:"#ffffff80"})]),(0,a.Uk)("Unfollow @"+(0,n.zw)(ie.value.username),1)])),H])])):(0,a.kq)("",!0)],8,C)]),(0,a._)("div",P,["reply"===G.tweet.type&&G.tweet.replyingToTweet?((0,a.wg)(),(0,a.iD)("div",z,[W,(0,a._)("a",{class:"blue-link",onClick:i[5]||(i[5]=(0,r.iM)((e=>(0,l.SU)(ee).viewUserProfile(ae.value)),["stop"]))},"@"+(0,n.zw)(ae.value),1)])):(0,a.kq)("",!0),(0,a._)("div",R,[(0,a.Wm)(u.Z,{text:G.tweet.text},null,8,["text"])]),G.tweet.media.length>0?((0,a.wg)(),(0,a.iD)("div",{key:1,class:(0,n.C_)(["tweet-media",[(0,l.SU)(d.YM)(G.tweet.media)]])},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(G.tweet.media,(e=>((0,a.wg)(),(0,a.iD)("div",{class:"image-preview-wrapper",key:G.tweet.media.indexOf(e)},[(0,a._)("img",{src:e},null,8,A)])))),128))],2)):(0,a.kq)("",!0)]),(0,a._)("div",Z,[(0,a._)("span",j,[(0,a._)("span",{class:"tweet-action-icon reply-btn",onClick:(0,r.iM)(ke,["stop"])},[(0,a.Wm)(s,{name:"fa-regular-comment",scale:"1.0",fill:"#ffffff80"})],8,E),(0,a._)("span",F,(0,n.zw)(G.tweet.repliesFrom.length>0?G.tweet.repliesFrom.length:""),1)]),(0,a._)("span",L,[(0,a._)("span",{class:(0,n.C_)(["tweet-action-icon retweet-btn",{retweeted:de.value}]),onClick:(0,r.iM)(ye,["stop"])},[(0,a.Wm)(s,{name:"la-retweet-solid",scale:"1.15",fill:"#ffffff80"})],10,B),(0,a._)("span",$,[we.value>0?((0,a.wg)(),(0,a.iD)("span",O,(0,n.zw)(we.value),1)):(0,a.kq)("",!0)])]),(0,a._)("span",Y,[(0,a._)("span",{class:(0,n.C_)(["tweet-action-icon like-btn",{liked:ue.value}]),onClick:(0,r.iM)(pe,["stop"])},[(0,a.Wm)(s,{name:"fa-regular-heart",scale:"1.0",fill:"#ffffff80"})],10,J),(0,a._)("span",K,[ce.value>0?((0,a.wg)(),(0,a.iD)("span",V,(0,n.zw)(ce.value),1)):(0,a.kq)("",!0)])]),(0,a._)("span",{class:"tweet-action-icon share-tweet-btn",onClick:(0,r.iM)(ge,["stop"])},[(0,a.Wm)(s,{name:"gi-share",scale:"1.0",fill:"#ffffff80"})],8,X)])])])],2)}}};const Q=G;var ee=Q}}]);
//# sourceMappingURL=146.630e5cd9.js.map