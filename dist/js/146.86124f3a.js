"use strict";(self["webpackChunkchitter"]=self["webpackChunkchitter"]||[]).push([[146],{6146:function(e,t,a){a.r(t),a.d(t,{default:function(){return P}});var i=a(3396),n=a(4870),l=a(988),r=a(9242),s=a(7925),o=a(2473),c=a(7139),u=a(8341),w=a(9327);const d={class:"icon-container"},f={key:0,class:"notif-icon"},m={key:1,class:"notif-icon"},v={key:2,class:"notif-icon"},p={class:"notif-body"},y={class:"notif-text"},k={class:"tweet-text gray-text"},g={key:0};var U={__name:"NotificationCard",props:{type:String,id:String,avatarUrl:String,name:String,username:String,tweetText:String,containsMedia:Boolean,isNew:Boolean},setup(e){const t=e,a=(0,w.q)(),l=(0,i.Fl)((()=>{switch(t.type){case"like-origin":return" liked your Tweet";case"like-retweet":return" liked your Retweet";case"retweet-origin":return" Retweeted your Tweet";case"retweet-retweet":return" Retweeted your Retweet";default:return" followed you"}})),r=(0,i.Fl)((()=>` pic.chitter.com/${t.id}`)),s=(0,i.Fl)((()=>"like-origin"===t.type||"like-retweet"===t.type)),o=(0,i.Fl)((()=>"retweet-origin"===t.type||"retweet-retweet"===t.type));function U(){"follow"===t.type?a.viewUserProfile(t.username):a.viewTweet(t.id)}return(a,w)=>{const _=(0,i.up)("v-icon");return(0,i.wg)(),(0,i.iD)("div",{class:(0,c.C_)(["notif-container",{new:e.isNew}]),onClick:U},[(0,i._)("div",d,[(0,n.SU)(s)?((0,i.wg)(),(0,i.iD)("span",f,[(0,i.Wm)(_,{name:"bi-heart-fill",scale:"1.6",fill:"#e21c68"})])):(0,n.SU)(o)?((0,i.wg)(),(0,i.iD)("span",m,[(0,i.Wm)(_,{name:"la-retweet-solid",scale:"1.6",fill:"#10d3a9"})])):"follow"===t.type?((0,i.wg)(),(0,i.iD)("span",v,[(0,i.Wm)(_,{name:"io-person",scale:"1.5",fill:"#14b5f5"})])):(0,i.kq)("",!0)]),(0,i._)("div",p,[(0,i.Wm)(u.Z,{url:t.avatarUrl,size:32},null,8,["url"]),(0,i._)("div",y,[(0,i._)("strong",null,(0,c.zw)(t.name),1),(0,i.Uk)((0,c.zw)((0,n.SU)(l)),1)]),(0,i._)("div",k,[(0,i.Uk)((0,c.zw)(t.tweetText),1),e.containsMedia?((0,i.wg)(),(0,i.iD)("span",g,(0,c.zw)((0,n.SU)(r)),1)):(0,i.kq)("",!0)])])],2)}}};const _=U;var S=_,N=a(3301),x=a.n(N);const C={class:"notif-list"},b={key:1,class:"error gray-text"};var h={__name:"NotificationList",props:{notifs:Array},async setup(e){let t,a;const c=e;var u=new(x());const w=(0,s.g)(),d=(0,l.U)(),f=(0,n.iH)(([t,a]=(0,i.mv)((async()=>Promise.all(c.notifs.map((async e=>{const t=e.tweetId?await w.getTweet(e.tweetId):null;if("reply"===e.type||"mention"===e.type)return Object.assign(e,{id:t.id,tweet:t,isNewNotification:d.tweetIsNewNotification(e.tweetId)});{const a=await d.getUser(e.fromUser);return Object.assign(e,{id:t?t.id:null,type:e.type,name:a.name,username:a.username,avatarUrl:a.avatarUrl,tweetText:t?t.text:null,containsMedia:t?t.media.length>0:null,isNew:d.isNewNotification(e)})}}))))),t=await t,a(),t).reverse());return(e,t)=>((0,i.wg)(),(0,i.iD)("div",C,[f.value.length>0?((0,i.wg)(),(0,i.j4)(r.W3,{key:0,name:"fade-down"},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(f.value,((e,t)=>((0,i.wg)(),(0,i.iD)(i.HY,null,["reply"===e.type?((0,i.wg)(),(0,i.j4)(o.Z,{key:e.id+(0,n.SU)(u)(),id:e.id,user:(0,n.SU)(d).getUserProps(e.fromUser),tweet:e.tweet,type:"reply",replyingTo:(0,n.SU)(d).currentUser.username,isNewNotification:e.isNewNotification},null,8,["id","user","tweet","replyingTo","isNewNotification"])):"mention"===e.type?((0,i.wg)(),(0,i.j4)(o.Z,{key:e.id+(0,n.SU)(u)(),id:e.id,user:(0,n.SU)(d).getUserProps(e.fromUser),tweet:e.tweet,type:"status",isNewNotification:e.isNewNotification},null,8,["id","user","tweet","isNewNotification"])):"reply"!==e.type&&"follow"!==e.type?((0,i.wg)(),(0,i.j4)(S,{key:t+(0,n.SU)(u)(),id:e.id,type:e.type,avatarUrl:e.avatarUrl,name:e.name,username:e.username,tweetText:e.tweetText,containsMedia:e.media&&e.media.length>0,isNew:e.isNew},null,8,["id","type","avatarUrl","name","username","tweetText","containsMedia","isNew"])):((0,i.wg)(),(0,i.j4)(S,{key:t+(0,n.SU)(u)(),type:e.type,avatarUrl:e.avatarUrl,name:e.name,username:e.username,isNew:e.isNew},null,8,["type","avatarUrl","name","username","isNew"]))],64)))),256))])),_:1})):((0,i.wg)(),(0,i.iD)("div",b,"No notifications to display"))]))}},D=a(89);const T=(0,D.Z)(h,[["__scopeId","data-v-26b45e8c"]]);var I=T;const q={class:"tweet-list-container"};var M={__name:"NotificationView",setup(e){const t=(0,l.U)(),a=(0,i.Fl)((()=>t.getAllNotifications()));return(0,i.Ah)((()=>{t.clearNotifications()})),(e,t)=>((0,i.wg)(),(0,i.iD)("div",q,[(0,i.Wm)(I,{notifs:(0,n.SU)(a)},null,8,["notifs"])]))}};const H=M;var P=H},6601:function(e,t,a){a.d(t,{Z:function(){return w}});var i=a(3396),n=a(4870),l=a(9707),r=a(9327);const s=["innerHTML"];var o={__name:"EmbeddedText",props:["text"],setup(e){const t=e,a=(0,r.q)(),o=(0,n.iH)(null);function c(){if(!t.text||0===t.text.length)return;const e=t.text.split(" ").map((e=>{const t=e.split(/\r?\n/);switch(!0){case l.yV.test(e):return`<a class="blue-link" href="${e}" target="_blank">${e}</a>`;case l.nC.test(e):return`<a class="blue-link">${e}</a>`;case t.some((e=>l.PH.test(e))):return t.map((a=>l.PH.test(a)?`<a class="blue-link user-link" data-username=${e.replace("@","")}>${t.filter((e=>l.PH.test(e)))[0]}</a>`:a)).join("\n");default:return e}}));return e.join(" ")}const u=e=>{e.stopPropagation(),a.viewUserProfile(e.currentTarget.dataset.username)};return(0,i.bv)((()=>{const e=o.value.querySelectorAll(".user-link");Array.from(e).forEach((e=>e.addEventListener("click",u)))})),(0,i.Xn)((()=>{const e=o.value.querySelectorAll(".user-link");Array.from(e).forEach((e=>e.removeEventListener("click",u)))})),(0,i.ic)((()=>{const e=o.value.querySelectorAll(".user-link");Array.from(e).forEach((e=>e.addEventListener("click",u)))})),(0,i.Jd)((()=>{const e=o.value.querySelectorAll(".user-link");Array.from(e).forEach((e=>e.removeEventListener("click",u)))})),(e,t)=>((0,i.wg)(),(0,i.iD)("div",{ref_key:"textEl",ref:o,innerHTML:c()},null,8,s))}},c=a(89);const u=(0,c.Z)(o,[["__scopeId","data-v-50c560dd"]]);var w=u},2473:function(e,t,a){a.d(t,{Z:function(){return ee}});var i=a(3396),n=a(7139),l=a(4870),r=a(9242),s=a(5743),o=a.n(s),c=a(8341),u=a(6601),w=a(1172),d=a(9707),f=a(7925),m=a(9327),v=a(988);const p={key:0,class:"user-retweet gray-text"},y={class:"retweeted-by"},k={class:"tweet-body"},g={class:"profile-pic-container"},U={key:0,class:"gray-line"},_={class:"tweet-data"},S={class:"user-info-and-btn"},N={class:"user-info-wrapper"},x=(0,i._)("span",{class:"separator gray-text"},"Â·",-1),C={class:"tweet-time gray-text"},b=["onClick"],h={key:0,class:"overlay"},D={key:1,class:"tweet-menu-container"},T={class:"tweet-menu-list"},I={class:"tweet-menu-icon"},q={class:"tweet-menu-icon"},M={class:"tweet-menu-icon"},H=(0,i._)("button",{class:"cancel-btn"},"Cancel",-1),P={class:"tweet-content"},z={key:0,class:"replying-to"},W=(0,i._)("span",{class:"gray-text"},"Replying to ",-1),R={class:"tweet-text"},A=["src"],Z={class:"tweet-actions-wrapper"},j={class:"tweet-metrics"},E=["onClick"],F={class:"tweet-metric reply-metric gray-text"},L={class:"tweet-metrics"},B=["onClick"],$={class:"tweet-metric retweet-metric gray-text"},O={key:0},Y={class:"tweet-metrics"},J=["onClick"],K={class:"tweet-metric like-metric gray-text"},V={key:0},X=["onClick"];var G={__name:"TweetCard",props:{id:String,user:[Object,Promise],tweet:Object,retweetedBy:String,replyingTo:[String,Promise],isPreviousReply:Boolean,isNewNotification:Boolean},async setup(e){let t,s;const G=e,Q=(0,f.g)(),ee=(0,m.q)(),te=(0,v.U)(),ae=(0,l.iH)(([t,s]=(0,i.mv)((()=>G.user)),t=await t,s(),t)),ie=(0,l.iH)(([t,s]=(0,i.mv)((()=>G.replyingTo)),t=await t,s(),t));var ne=a(893);o().extend(ne);let le=null;const re=(0,l.iH)(!1),se=(0,l.iH)(o()().toISOString()),oe=(0,l.iH)(w.Z.formatTweetDate(G.tweet.timestamp,se.value)),ce=(0,l.iH)(G.tweet.likeCount),ue=(0,l.iH)(([t,s]=(0,i.mv)((()=>Q.hasLiked(G.id,te.currentId))),t=await t,s(),t)),we=(0,l.iH)(G.tweet.retweetCount),de=(0,l.iH)(([t,s]=(0,i.mv)((()=>Q.hasRetweeted(G.id,te.currentId))),t=await t,s(),t)),fe=(0,i.Fl)((()=>te.canFollow(ae.value.id))),me=()=>{te.currentId&&(re.value=!re.value)},ve=()=>{te.currentId&&Q.removeTweet(G.id,ae.value.id)},pe=()=>{te.currentId&&(ue.value?(Q.removeLike(G.id,te.currentId,ae.value.id),ce.value--,ue.value=!1):(Q.addLike(G.id,te.currentId,G.retweetedBy),ce.value++,ue.value=!0))},ye=()=>{te.currentId&&(de.value?(Q.removeRetweet(G.id,te.currentId,ae.value.id),we.value--,de.value=!1):(Q.addRetweet(G.id,te.currentId,G.retweetedBy),we.value++,de.value=!0))},ke=()=>{te.currentId&&(ee.setModalType("reply"),ee.setModalReply(ae.value.id,G.id),ee.toggleModal())},ge=()=>{ee.toast("Copied to clipboard"),navigator.clipboard.writeText(`${window.location.host}/status/${G.id}`)};return(0,i.bv)((()=>{o()(se.value).diff(o()(G.tweet.timestamp),"hour")>23||(le=setInterval((()=>{oe.value!==w.Z.formatTweetDate(G.tweet.timestamp,se.value)&&(oe.value=w.Z.formatTweetDate(G.tweet.timestamp,se.value))}),3e4))})),(0,i.Jd)((()=>{clearInterval(le)})),(t,a)=>{const s=(0,i.up)("v-icon");return(0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)(["tweet-container",{border:!e.isPreviousReply,new:e.isNewNotification}]),onClick:a[6]||(a[6]=e=>(0,l.SU)(ee).viewTweet(G.id))},[G.retweetedBy?((0,i.wg)(),(0,i.iD)("div",p,[(0,i.Wm)(s,{name:"la-retweet-solid",scale:"0.89",fill:"#ffffff80"}),(0,i._)("span",y,(0,n.zw)(G.retweetedBy)+" Retweeted",1)])):(0,i.kq)("",!0),(0,i._)("div",k,[(0,i._)("div",g,[(0,i.Wm)(c.Z,{url:ae.value.avatarUrl,size:48,onClick:a[0]||(a[0]=(0,r.iM)((e=>(0,l.SU)(ee).viewUserProfile(ae.value.username)),["stop"]))},null,8,["url"]),e.isPreviousReply?((0,i.wg)(),(0,i.iD)("div",U)):(0,i.kq)("",!0)]),(0,i._)("div",_,[(0,i._)("div",S,[(0,i._)("div",N,[(0,i._)("span",{class:"display-name",onClick:a[1]||(a[1]=(0,r.iM)((e=>(0,l.SU)(ee).viewUserProfile(ae.value.username)),["stop"]))},[(0,i._)("a",null,(0,n.zw)(ae.value.name),1)]),(0,i._)("span",{class:"username gray-text",onClick:a[2]||(a[2]=(0,r.iM)((e=>(0,l.SU)(ee).viewUserProfile(ae.value.username)),["stop"]))},[(0,i._)("a",null,"@"+(0,n.zw)(ae.value.username),1)]),x,(0,i._)("span",C,(0,n.zw)(oe.value),1)]),(0,i._)("span",{class:"tweet-action-icon extra-btn",onClick:(0,r.iM)(me,["stop"])},[(0,i.Wm)(s,{name:"hi-dots-horizontal",scale:"1.0",fill:"#ffffff80"}),re.value?((0,i.wg)(),(0,i.iD)("div",h)):(0,i.kq)("",!0),re.value?((0,i.wg)(),(0,i.iD)("div",D,[(0,i._)("ul",T,[(0,l.SU)(te).currentId==ae.value.id||(0,l.SU)(te).currentUser.isAdmin?((0,i.wg)(),(0,i.iD)("li",{key:0,class:"tweet-menu-item delete-tweet",onClick:ve},[(0,i._)("span",I,[(0,i.Wm)(s,{name:"bi-trash",scale:"1.1",fill:"red"})]),(0,i.Uk)("Delete ")])):(0,i.kq)("",!0),(0,l.SU)(te).currentId!==ae.value.id&&(0,l.SU)(fe)?((0,i.wg)(),(0,i.iD)("li",{key:1,class:"tweet-menu-item",onClick:a[3]||(a[3]=e=>(0,l.SU)(te).followUser(ae.value.id))},[(0,i._)("span",q,[(0,i.Wm)(s,{name:"co-user-follow",scale:"1.1",fill:"#ffffff80"})]),(0,i.Uk)("Follow @"+(0,n.zw)(ae.value.username),1)])):(0,i.kq)("",!0),(0,l.SU)(te).currentId===ae.value.id||(0,l.SU)(fe)?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("li",{key:2,class:"tweet-menu-item",onClick:a[4]||(a[4]=e=>(0,l.SU)(te).unfollowUser(ae.value.id))},[(0,i._)("span",M,[(0,i.Wm)(s,{name:"co-user-unfollow",scale:"1.1",fill:"#ffffff80"})]),(0,i.Uk)("Unfollow @"+(0,n.zw)(ae.value.username),1)])),H])])):(0,i.kq)("",!0)],8,b)]),(0,i._)("div",P,["reply"===G.tweet.type&&G.tweet.replyingToTweet?((0,i.wg)(),(0,i.iD)("div",z,[W,(0,i._)("a",{class:"blue-link",onClick:a[5]||(a[5]=(0,r.iM)((e=>(0,l.SU)(ee).viewUserProfile(ie.value)),["stop"]))},"@"+(0,n.zw)(ie.value),1)])):(0,i.kq)("",!0),(0,i._)("div",R,[(0,i.Wm)(u.Z,{text:G.tweet.text},null,8,["text"])]),G.tweet.media.length>0?((0,i.wg)(),(0,i.iD)("div",{key:1,class:(0,n.C_)(["tweet-media",[(0,l.SU)(d.YM)(G.tweet.media)]])},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(G.tweet.media,(e=>((0,i.wg)(),(0,i.iD)("div",{class:"image-preview-wrapper",key:G.tweet.media.indexOf(e)},[(0,i._)("img",{src:e},null,8,A)])))),128))],2)):(0,i.kq)("",!0)]),(0,i._)("div",Z,[(0,i._)("span",j,[(0,i._)("span",{class:"tweet-action-icon reply-btn",onClick:(0,r.iM)(ke,["stop"])},[(0,i.Wm)(s,{name:"fa-regular-comment",scale:"1.0",fill:"#ffffff80"})],8,E),(0,i._)("span",F,(0,n.zw)(G.tweet.repliesFrom.length>0?G.tweet.repliesFrom.length:""),1)]),(0,i._)("span",L,[(0,i._)("span",{class:(0,n.C_)(["tweet-action-icon retweet-btn",{retweeted:de.value}]),onClick:(0,r.iM)(ye,["stop"])},[(0,i.Wm)(s,{name:"la-retweet-solid",scale:"1.15",fill:"#ffffff80"})],10,B),(0,i._)("span",$,[we.value>0?((0,i.wg)(),(0,i.iD)("span",O,(0,n.zw)(we.value),1)):(0,i.kq)("",!0)])]),(0,i._)("span",Y,[(0,i._)("span",{class:(0,n.C_)(["tweet-action-icon like-btn",{liked:ue.value}]),onClick:(0,r.iM)(pe,["stop"])},[(0,i.Wm)(s,{name:"fa-regular-heart",scale:"1.0",fill:"#ffffff80"})],10,J),(0,i._)("span",K,[ce.value>0?((0,i.wg)(),(0,i.iD)("span",V,(0,n.zw)(ce.value),1)):(0,i.kq)("",!0)])]),(0,i._)("span",{class:"tweet-action-icon share-tweet-btn",onClick:(0,r.iM)(ge,["stop"])},[(0,i.Wm)(s,{name:"gi-share",scale:"1.0",fill:"#ffffff80"})],8,X)])])])],2)}}};const Q=G;var ee=Q}}]);
//# sourceMappingURL=146.86124f3a.js.map